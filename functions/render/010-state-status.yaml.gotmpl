# code: language=yaml
#
# Compute status values from observed state
#

{{- $cnpg := $state.cloudnativePg }}
{{- $obs := $state.observed }}

# ==============================================================================
# Compute status output
# ==============================================================================

# Determine overall ready state from observed Helm release
{{- $helmReady := $obs.helmRelease.ready | default false }}
{{- $ready := $helmReady }}

{{- $state = set $state "status" (dict
  "ready" $ready
  "release" (dict
    "name" $cnpg.releaseName
    "namespace" $cnpg.namespace
    "ready" $helmReady
  )
) }}
